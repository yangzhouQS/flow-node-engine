# 项目概述

## 项目简介

**flow-node-engine** 是一个基于 Node.js + NestJS + MySQL 实现的完整工作流引擎，旨在为 JavaScript/TypeScript 生态提供一个功能强大的 BPMN（业务流程模型与标记）流程引擎解决方案。

> **项目定位**：用现代 TypeScript 技术栈重新实现 Flowable 流程引擎的核心功能，让前端和后端团队能够使用同一种语言进行开发，降低技术栈复杂度。

## 核心功能特性

### 1. BPMN 流程引擎
- **完整流程执行**：支持流程启动、暂停、恢复、终止等生命周期管理
- **多种网关支持**：排他网关（Exclusive）、并行网关（Parallel）、包容网关（Inclusive）
- **子流程**：支持普通子流程、调用活动（Call Activity）、事件子流程
- **多实例**：支持顺序多实例和并行多实例
- **补偿机制**：支持补偿边界事件和补偿抛出事件

### 2. DMN 决策引擎
- **决策表执行**：支持完整的 DMN 1.1/1.3 标准
- **多种命中策略**：UNIQUE、FIRST、PRIORITY、ANY、COLLECT 等 8 种命中策略
- **FEEL 表达式**：支持 DMN 标准 FEEL 表达式语法
- **聚合函数**：支持 SUM、COUNT、MIN、MAX 等聚合操作

### 3. 任务服务
- **任务管理**：创建、认领、完成、委派、转办任务
- **候选机制**：支持候选用户和候选组
- **任务驳回**：支持多层级驳回配置和驳回历史记录
- **任务抄送**：支持抄送配置和抄送记录
- **任务监听**：支持任务创建、分配、完成、删除等事件监听

### 4. 表单引擎
- **动态表单**：支持动态字段配置
- **表单验证**：支持字段级和表单级验证
- **多种字段类型**：文本、数字、日期、选择器等多种类型

### 5. 历史服务
- **完整历史记录**：记录流程实例、任务、活动、变量的历史数据
- **历史归档**：支持历史数据归档
- **历史清理**：支持历史数据自动清理

### 6. 扩展功能
- **评论服务**：支持流程实例和任务的评论功能
- **通知服务**：支持多种通知方式（站内信、推送等）
- **进度跟踪**：实时跟踪流程执行进度
- **批处理服务**：支持批量操作
- **内容管理**：支持附件上传和管理

## 技术栈

| 类别 | 技术 |
|------|------|
| **运行时** | Node.js 18+ |
| **框架** | NestJS 11.x |
| **语言** | TypeScript 5.x |
| **数据库** | MySQL 8.0 + TypeORM |
| **缓存** | Redis |
| **任务队列** | Bull + Redis |
| **API 文档** | Swagger/OpenAPI |
| **日志** | Winston |
| **测试** | Vitest |

## 开源协议

本项目基于 **MIT** 协议开源，你可以免费使用、修改和分发本项目。

## 与 Flowable 对比

| 特性 | flow-node-engine | Flowable (Java) |
|------|-----------------|-----------------|
| **语言** | TypeScript | Java |
| **框架** | NestJS | Spring |
| **数据库** | MySQL + TypeORM | MyBatis |
| **BPMN 覆盖率** | ~75% | 100% |
| **DMN 覆盖率** | ~70% | 100% |
| **任务服务** | ~85% | 100% |

flow-node-engine 在实现 Flowable 核心功能的同时，还增加了一些更适合 TypeScript 生态的扩展功能，如任务驳回增强、进度跟踪等。

---

## 项目背景与价值

### 解决的核心问题

1. **技术栈统一**：在前后端分离的开发模式中，流程引擎通常需要使用 Java 实现，导致团队需要维护两套技术栈。flow-node-engine 使用 TypeScript/Node.js 实现，让前端开发者也能参与流程引擎的开发。

2. **微服务友好**：现代应用架构越来越多的采用微服务架构，使用 Node.js 实现流程引擎可以更好地融入微服务生态，与其他 Node.js 服务无缝集成。

3. **轻量部署**：相比 Java 运行时，Node.js 的资源消耗更低，部署更简单，特别适合中小规模的业务场景。

### 差异化优势

1. **TypeScript 强类型**：全程使用 TypeScript 开发，提供完整的类型定义，享受静态类型检查带来的安全保障。

2. **NestJS 架构**：采用 NestJS 框架，借鉴 Angular 的模块化设计，提供清晰的代码组织结构和依赖注入机制。

3. **任务驳回增强**：在 Flowable 基础上增强了任务驳回功能，支持多层级驳回、驳回配置和驳回历史。

4. **进度跟踪**：提供实时的流程进度跟踪功能，方便用户了解流程执行状态。

5. **前后端技术栈统一**：对于使用 TypeScript 的团队，可以实现前后端技术栈统一，减少技术切换成本。

### 设计理念

flow-node-engine 的设计遵循以下理念：

1. **保持简洁**：在保证功能完整的前提下，尽可能保持代码简洁易懂。

2. **遵循标准**：严格遵循 BPMN 2.0 和 DMN 1.3 国际标准，确保流程定义的可移植性。

3. **模块化设计**：采用模块化设计思想，各功能模块之间低耦合高内聚，便于扩展和维护。

4. **开箱即用**：提供丰富的默认配置，让用户能够快速上手使用。

### 适用人群与场景

**适用人群：**
- 前端开发者希望参与流程引擎开发
- Node.js 团队需要工作流引擎
- 中小型团队需要轻量级流程解决方案
- 对 Java 技术栈不熟悉的开发者

**典型应用场景：**
- 企业审批流程系统
- 业务流程自动化（BPA）
- 业务流程管理系统（BPMS）
- 决策管理系统
- 工作流编排平台
